@model IEnumerable<AppConfigManagement.Models.Machine>

@using GridMvc.Html
@{
    ViewBag.Title = "ManageAppConfig";
}

<h2>ManageAppConfig</h2>

@Html.ActionLink("Click to Add Machine", "AddMachine", "Machine", new { @class = "modal-link" })
<p />

@Html.Grid(Model).Columns(columns =>
{
    columns.Add(o => o.machine_name)
            .Titled("Name")
            .Sortable(true)
            .Filterable(true)

            .SetWidth(100);

    columns.Add(o => o.active)
            .Titled("Active")
            .SetWidth(10);

    columns.Add(o => o.location)
            .Titled("Location")
            .SetWidth(100);

    columns.Add(o => o.usage)
            .Titled("Usage")
            .SetWidth(100);

    columns.Add(o => o.create_date, "Date Added")
            .Titled("Date Added")
            .Format("{0:dd/MM/yyyy}")
            .SetWidth(110);

    columns.Add(o => o.modify_date)
            .Titled("Date Last Modified")
            .Format("{0:dd/MM/yyyy}")
            .SetWidth(150);

    columns.Add()
            .Encoded(false)
            .Sanitized(false)
            .SetWidth(30)
            .RenderValueAs(d =>
                @<b>
                    @Html.ActionLink("EditMachine", "EditMachine", "EditMachine", new { id = d.id }, new { @class = "modal-link" })
                </b>);

    }).SetRowCssClasses(item => item.active ? "warning" : string.Empty).WithPaging(15).Sortable().Filterable().WithMultipleFilters()

    <script>
        $(function () {
            pageGrids.ordersGrid.onRowSelect(function (e) {
                alert(e.row.OrderID);
            });
        });
    </script>

    <!-- Modal -->
    <div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                ×
            </button>
            <h3 id="myModalLabel">
                Edit Customer
            </h3>
        </div>
        <div class="modal-body">
            <p>
                Loading…
            </p>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">
                Close
            </button>
        </div>
    </div>
    <script type="text/javascript">
        //this script reset modal each time when you click on the link:
        $(function () {
            $(".modal-link").click(function (event) {
                event.preventDefault();
                $('#myModal').removeData("modal");
                $('#myModal').modal({ remote: $(this).attr("href") });
            });
        })
    </script>
